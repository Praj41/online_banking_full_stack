<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

<style>
    th {
        color: black;
    }

    td {
        background-color: white;
    }

    body {

        background-color: #283149;
    }

    .button {
        top: 10%;
        right: 0;
        position: absolute
        background-color: silver;
        transition-duration: 0.4s;
        border-radius: 12px;
        width: 75px;
        height: 50px;
        margin: 25px 100px 25px 0px;
    }

    .button:hover {
        background-color: black; /* Green */
        color: white;
    }

    .center {
        margin-top: 3%;
        margin-left: auto;
        margin-right: auto;
    }

    h1 {
        font-size: 5rem;
        color: #DBEDF3;
        font-family: "Arvo", cursive;
        text-shadow: 3px 0 #DA0463;
    }

</style>
<body>
<button class="button" onclick="signin()">Back</button>
<h1>Transaction Histroy</h1>
<table class="center">
    <table class="table-responsive">
        <table class="table table-striped table-sm">

            <tr class="bg-info">
                <th>ID</th>
                <th>Amount</th>
                <th>Available_balance</th>
                <th>Date</th>
                <th>Description</th>
                <th>Status</th>
                <th>type</th>
                <th>Primary_account_id</th>
                <th>Loan_account_id</th>
            </tr>

            <tbody id="myTable">

            </tbody>
        </table>

</body>

<script>
    var myArray;
    var loginRequest = new XMLHttpRequest();
    var loginRequest1 = new XMLHttpRequest();

    const param = new URLSearchParams(window.location.search);



    loginRequest1.open('GET', 'http://localhost:8080/api/v1/user/'+param.get('id'));

    //loginRequest.setRequestHeader("Content-Type", "application/json");


    loginRequest1.send();
    var myvar;

    loginRequest1.onload = function () {
        myvar = JSON.parse(loginRequest1.responseText)
        loginRequest.open('GET', 'http://localhost:8080/api/v1/transaction/'+myvar.pid);
        loginRequest.send();
    }


    loginRequest.onload = function () {

        myArray = JSON.parse(loginRequest.responseText);

        buildTable(myArray);
    }

    function buildTable(data) {
        var table = document.getElementById('myTable')

        for (var i = 0; i < data.length; i++) {
            var row = `<tr>
							<td>${data[i].id}</td>
							<td>${data[i].amount}</td>
              <td>${data[i].available_balance}</td>
							<td>${data[i].date}</td>
              <td>${data[i].description}</td>
              <td>${data[i].status}</td>
              <td>${data[i].type}</td>
              <td>${data[i].primary_account_id}</td>
              <td>${data[i].loan_account_id}</td>
					  </tr>`
            table.innerHTML += row


        }
    }

    function signin() {
        window.location.replace("signin.html");
    }

</script>
